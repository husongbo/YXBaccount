<!DOCTYPE html>
<html lang="en">

	<head>
		<meta charset="UTF-8">
		<meta name="viewport" content="width=device-width,initial-scale=1.0,maximum-scale=1.0,user-scalable=no">
		<title>首页</title>
		<link rel="stylesheet" href="//g.alicdn.com/msui/sm/0.6.2/css/sm.min.css">
		<link rel="stylesheet" href="Common/css/common.css" />
		<link rel="stylesheet" href="Common/css/iconfont.css" />
		<script type="text/javascript" src="../Common/js/layer_mobile/layer.js"></script>
		<style>
			.col-33 {
				padding: 0.5rem;
				text-align: center;
			}
			
			.col-33 .iconfont {
				color: #FFFFFF;
				font-size: 30px;
			}
			
			.col-33 div {
				font-size: 0.65rem;
			}
			
			.card-content-inner {
				padding: 0.5rem;
			}
			
			.marquee {
				height: 3.7rem;
				overflow: hidden;
			}
			
			.marquee ul {
				list-style: none;
				padding-left: 0;
			}
			
			.list-block ul:after {
				height: 0;
			}
			
			p {
				margin: 0;
				margin-top: 0.3rem;
			}
			
			.layui-m-layercont {
				padding: 30px 0;
			}
			
			.layui-m-layercont div {
				box-sizing: border-box;
				width: 86%;
				margin-left: 7%;
				text-align: left;
				font-size: 0.7rem;
				border: 1px solid #DDDDDD;
				padding: 0.3rem 0.5rem;
				border-radius: 0.3rem;
			}
			
			.layui-m-layercont div:first-child {
				margin-bottom: 1.5rem;
			}
			
			.layui-m-layercont input {
				border: none;
				padding-left: 0.3rem;
				height: 100%;
			}
			
			input[type="tel"] {
				width: 60%;
			}
			
			input[type="number"] {
				width: 40%;
			}
			
			.layui-m-layercont span {
				float: right;
				color: #E4393C;
			}
		</style>

		<!--我的抽奖券-->
		<script type="text/template" id="wdcjq_Template">
			<div>奖券共：{{抽奖卷数}} 张</div>
			<div>已中奖：{{已中奖抽奖卷数}} 张</div>
			<div>中奖率：{{中奖百分率}}</div>
			<div id="wdjq" style="text-align: right;color: #E4393C;"> 查看详情</div>
		</script>

		<!--获奖公示-->
		<!--最热-->
		<script type="text/template" id="zr_Template">
			<div class="card">
				<div class="card-content">
					<div class="card-content-inner">
						<div class="img">
							<img src="{{T0001_IMAGE}}" alt="" />
						</div>
						<div>{{M0003_NAME}}</div>
						<p class="describe">{{MEMO}}</p>
						<button class="join" data-code="{{T0001_ACTION_CODE}}">参与抽奖</button>
					</div>
				</div>
			</div>
		</script>

		<!--最新-->
		<script type="text/template" id="zx_Template">
			<div class="card">
				<div class="card-content">
					<div class="card-content-inner">
						<div class="img">
							<img src="{{T0001_IMAGE}}" alt="" />
						</div>
						<div>{{M0003_NAME}}</div>
						<p class="describe">{{MEMO}}</p>
						<button class="join" data-code="{{T0001_ACTION_CODE}}">参与抽奖</button>
					</div>
				</div>
			</div>
		</script>

	</head>

	<body>
		<div class="page-group">
			<div class="page page-current">
				<header class="bar bar-nav">
					<h1 class="title">首页</h1>
				</header>

				<div class="content">
					<div class="row" style="background-color: #E4393C;color: #FFFFFF;margin-bottom: 0.3rem;">
						<div class="col-33">
							<span class="iconfont icon-jiangjin"></span>
							<div>奖金池</div>
							<div>21.00元</div>
						</div>
						<div class="col-33">
							<span class="iconfont icon-cishu"></span>
							<div>抽奖次数</div>
							<div>3次</div>
						</div>
						<div class="col-33">
							<span class="iconfont icon-zhongjiang"></span>
							<div>中奖人数</div>
							<div>10人</div>
						</div>
					</div>
					<div class="flex-box">
						<div class="card">
							<div class="card-header" style="display: block;text-align: center;">我的抽奖券</div>
							<div class="card-content">
								<div class="card-content-inner" id="wdcjq"></div>
							</div>
						</div>
						<div class="card">
							<div class="card-header" style="display: block;text-align: center;">获奖公示</div>
							<div class="card-content">
								<div class="card-content-inner marquee">
									<ul>
										<li>139****1236获得100元加油券</li>
										<li>139****1236获得100元加油券</li>
										<li>139****1236获得100元加油券</li>
										<li>139****1236获得100元加油券</li>
									</ul>
								</div>
								<div id="zjmd" style="text-align: right;color: #E4393C;margin-right: 0.75rem;">查看更多</div>
							</div>
						</div>
					</div>

					<!--最热-->
					<div class="list-block">
						<ul>
							<li class="item-content item-link">
								<div class="item-inner">
									<div class="item-title">最热</div>
									<div class="item-after">更多</div>
								</div>
							</li>
						</ul>
					</div>
					<div class="flex-between-box" id="zr"></div>

					<!--最新-->
					<div class="list-block">
						<ul>
							<li class="item-content item-link">
								<div class="item-inner">
									<div class="item-title">最新</div>
									<div class="item-after">更多</div>
								</div>
							</li>
						</ul>
					</div>
					<div class="flex-between-box" id="zx"></div>
				</div>
			</div>
		</div>
		<script type='text/javascript' src='//g.alicdn.com/sj/lib/zepto/zepto.min.js' charset='utf-8'></script>
		<script type='text/javascript' src='//g.alicdn.com/msui/sm/0.6.2/js/sm.min.js' charset='utf-8'></script>
		<script type="text/javascript" src="Common/js/jquery.js"></script>
		<script type="text/javascript" src="Common/js/scroll.js"></script>
		<script type="text/javascript" src="../Common/js/sdk.js"></script>
		<script type="text/javascript" src="../Common/js/sdk_data_validation.js"></script>
		<script type="text/javascript" src="../Common/js/sdk_db.js?1=1"></script>

		<script>
			var page = {};
			page.elemClick = function() {

				// 我的奖券
				$("#wdcjq").bind("click", "#wdjq", function() {
					window.location.href = "wdjq.html"
				})

				// 中奖名单
				$("#zjmd").click(function() {
					window.location.href = "hjgs.html"
				});

				// 商品详情
				$("img").click(function() {
					window.location.href = "details.html"
				});

				// 参与抽奖
				$(".join").click(function() {
					console.log("参与")
				});
			};
			page.elemClick()

			// 获奖公示
			$(".marquee").myScroll({
				speed: 40, //数值越大，速度越慢
				rowHeight: 68 //li的高度
			});

			// 查询我的抽奖券
			var hyID = "0"
			var proc = "我的抽奖券 " + hyID;
			var rst = $$.JSONDB.Query(proc).Table;
			$$.Fill("#wdcjq", rst);

			// 获奖公示
			var proc = "获奖公示 ";
			var rst = $$.JSONDB.Query(proc).Table;
			console.log(rst)

			// 活动列表  最热1  最新2
			var shID = "1";

			function queryhdList(type) {
				var data = {
					"展示类型": type,
					"商户标识": shID
				}
				var tmpl = "{{展示类型}},{{商户标识}}";
				var params = tmpl.t(data);
				var proc = "活动列表 " + params;
				var rst = $$.JSONDB.Query(proc).Table;
				for(var i = 0; i < rst.length; i++) {
					var arr = rst[i].T0001_IMAGE.split(",");
					rst[i].T0001_IMAGE = decodeURI(atob(arr[0]));
				}
				return rst
			}
			console.log(queryhdList("1"))

			// 最热 最新
			$$.Fill("#zr", queryhdList("2"));
			$$.Fill("#zx", queryhdList("1"));

			// 参与抽奖
			$("button").bind("click", function() {
				layer.open({
					content: '<div><label for="">手机号</label>' +
						'<input type="tel" placeholder="请输入手机号" id="tel"/></div>' +
						'<div><label>验证码</label>' +
						'<input type="number" placeholder="请输入验证码" id="vaild"/>' +
						'<span>获取验证码</span></div>',
					btn: ['确定', '取消'],
					yes: function(index) {
						console.log($("#vaild").val())
						layer.close(index);
					}
				});

//				var code = $(this).attr("data-code");
//				var data = {
//					"活动编码": code,
//					"会员标识": hyID
//				}
//				var tmpl = "'{{活动编码}}',{{会员标识}}";
//				var params = tmpl.t(data);
//				var proc = "会员参与抽奖 " + params;
//				var rst = $$.JSONDB.Query(proc);
//				console.log(rst)
			})
		</script>
	</body>

</html>